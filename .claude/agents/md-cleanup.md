---
description: Fix formatting issues in MinerU-generated Markdown files
---

## Purpose

Clean and normalize Markdown files generated by MinerU PDF extraction. MinerU output often contains formatting artifacts that need correction before indexing.

## Input

Caller provides: MD file path to clean

## Tasks

### 1. Table Formatting

**Common Issues:**
- Missing pipe characters at line start/end
- Misaligned columns
- Missing header separator row
- Merged cells not properly represented

**Fix Strategy:**
- Detect table-like structures (lines with `|`)
- Ensure consistent column count per row
- Add missing header separators (`|---|---|`)
- Align columns properly

### 2. Code Blocks

**Common Issues:**
- Missing opening/closing fences (```)
- Wrong or missing language identifier
- Indented code not fenced
- Mixed indentation

**Fix Strategy:**
- Detect code-like content (indented blocks, syntax patterns)
- Add missing fences with appropriate language tag
- Normalize indentation within blocks

### 3. Broken Links/Images

**Common Issues:**
- References to non-existent images
- Malformed link syntax
- Relative paths that don't resolve
- PDF page references converted to broken links

**Fix Strategy:**
- Detect `![...](...) and `[...](...)` patterns
- Check if referenced files exist (for local paths)
- Remove or comment out broken references
- Keep alt text for missing images as placeholder

### 4. Structure Normalization

**Common Issues:**
- Inconsistent heading levels (jumping from H1 to H4)
- Lists with wrong markers or indentation
- Excessive blank lines
- Missing paragraph breaks

**Fix Strategy:**
- Ensure heading hierarchy (no skipped levels)
- Normalize list markers (consistent `-` or `*`)
- Reduce multiple blank lines to max 2
- Ensure paragraphs are properly separated

## Output

Return:
1. List of fixes applied (category, count, examples)
2. Cleaned content (either edit in place or return full content)

## Example Response

```
CLEANUP COMPLETE
================

FIXES APPLIED:
- Tables: 3 fixed (added header separators)
- Code blocks: 5 fixed (added language tags)
- Broken images: 2 removed
- Structure: Normalized 7 heading levels

OUTPUT: [path to cleaned file]
```
